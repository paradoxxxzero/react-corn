{"version":3,"file":"rerender-test.stories-ddb06a5e.js","sources":["../../stories/sandbox/rerender-test.stories.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\nimport { useCorn } from '@react-corn/core';\nimport { Quill } from '@react-corn/quill';\nimport { ButtonRow, Number, Select, Text } from '@react-corn/simple';\nimport { memo, useRef, useState } from 'react';\nconst initialItem = {\n  text: 'text',\n  int: 84,\n  html: '<p>H<strong>T</strong><u>M</u><em>L</em></p>',\n  select: Infinity\n};\n\n// const choices = {\n//   infinity: Infinity,\n//   nan: NaN,\n//   'negative infinity': -Infinity,\n// }\n\nconst choices = {\n  one: 'I',\n  two: 'II',\n  three: 'III',\n  four: 'IV',\n  five: 'V'\n};\nconst withRenderCount = Field =>\n// eslint-disable-next-line react/display-name\nmemo(({\n  children,\n  ...props\n}) => {\n  const rc = useRef(0);\n  const lastProps = useRef(props);\n  const changedProps = Object.keys(lastProps.current).concat(Object.keys(props)).filter((k, i, array) => array.indexOf(k) === i).filter(k => lastProps.current[k] !== props[k]);\n  // console.log(\n  //   ...changedProps.map(k => [props.name, k, lastProps.current[k], props[k]])\n  // )\n  lastProps.current = props;\n  rc.current++;\n  return <Field {...props}>\n        {children}\n        [render count: {rc.current} ({changedProps.join(', ')})]\n      </Field>;\n});\nconst TextRenderCount = withRenderCount(Text);\nconst NumberRenderCount = withRenderCount(Number);\nconst QuillRenderCount = withRenderCount(Quill);\nconst SelectRenderCount = withRenderCount(Select);\nconst ButtonRowRenderCount = withRenderCount(ButtonRow);\nconst inlineBlock = {\n  display: 'inline-block'\n};\nexport const ReRenderTest = () => {\n  const [item, setItem] = useState(initialItem);\n  const {\n    form,\n    field,\n    modified,\n    onReset\n  } = useCorn({\n    item,\n    onSubmit: newItem => {\n      const accepted = window.confirm(`You submitted \"${Object.values(newItem).join(', ')}\"`);\n      accepted && setItem(newItem);\n    }\n  });\n  return <form {...form}>\n      <TextRenderCount required {...field(`text`)}>\n        Text\n      </TextRenderCount>\n      <NumberRenderCount required {...field(`int`)}>\n        Number\n      </NumberRenderCount>\n      <QuillRenderCount style={inlineBlock} required {...field(`html`)}>\n        HTML\n      </QuillRenderCount>\n      <SelectRenderCount required choices={choices} {...field(`select`)}>\n        Select\n      </SelectRenderCount>\n\n      <div style={{\n      width: '100%'\n    }} />\n      <ButtonRowRenderCount>\n        <button disabled={!modified}>Submit</button>\n        <button type=\"button\" disabled={!modified} onClick={onReset}>\n          Reset\n        </button>\n      </ButtonRowRenderCount>\n    </form>;\n};\nexport default {\n  title: 'Sandbox/rerender-test',\n  parameters: {\n    options: {\n      showPanel: false\n    }\n  }\n};\nReRenderTest.parameters = {\n  ...ReRenderTest.parameters,\n  docs: {\n    ...ReRenderTest.parameters?.docs,\n    source: {\n      originalSource: \"() => {\\n  const [item, setItem] = useState(initialItem);\\n  const {\\n    form,\\n    field,\\n    modified,\\n    onReset\\n  } = useCorn({\\n    item,\\n    onSubmit: newItem => {\\n      const accepted = window.confirm(`You submitted \\\"${Object.values(newItem).join(', ')}\\\"`);\\n      accepted && setItem(newItem);\\n    }\\n  });\\n  return <form {...form}>\\n      <TextRenderCount required {...field(`text`)}>\\n        Text\\n      </TextRenderCount>\\n      <NumberRenderCount required {...field(`int`)}>\\n        Number\\n      </NumberRenderCount>\\n      <QuillRenderCount style={inlineBlock} required {...field(`html`)}>\\n        HTML\\n      </QuillRenderCount>\\n      <SelectRenderCount required choices={choices} {...field(`select`)}>\\n        Select\\n      </SelectRenderCount>\\n\\n      <div style={{\\n      width: '100%'\\n    }} />\\n      <ButtonRowRenderCount>\\n        <button disabled={!modified}>Submit</button>\\n        <button type=\\\"button\\\" disabled={!modified} onClick={onReset}>\\n          Reset\\n        </button>\\n      </ButtonRowRenderCount>\\n    </form>;\\n}\",\n      ...ReRenderTest.parameters?.docs?.source\n    }\n  }\n};"],"names":["initialItem","choices","withRenderCount","Field","memo","children","props","rc","useRef","lastProps","changedProps","k","i","array","jsxs","TextRenderCount","Text","NumberRenderCount","Number","QuillRenderCount","Quill","SelectRenderCount","Select","ButtonRowRenderCount","ButtonRow","inlineBlock","ReRenderTest","item","setItem","useState","form","field","modified","onReset","useCorn","newItem","jsx","rerenderTest_stories","_a","_c","_b"],"mappings":"4aAKA,MAAMA,EAAc,CAClB,KAAM,OACN,IAAK,GACL,KAAM,+CACN,OAAQ,GACV,EAQMC,EAAU,CACd,IAAK,IACL,IAAK,KACL,MAAO,MACP,KAAM,KACN,KAAM,GACR,EACMC,EAAkBC,GAExBC,EAAAA,KAAK,CAAC,CACJ,SAAAC,EACA,GAAGC,CAAA,IACC,CACE,MAAAC,EAAKC,SAAO,CAAC,EACbC,EAAYD,SAAOF,CAAK,EACxBI,EAAe,OAAO,KAAKD,EAAU,OAAO,EAAE,OAAO,OAAO,KAAKH,CAAK,CAAC,EAAE,OAAO,CAACK,EAAGC,EAAGC,IAAUA,EAAM,QAAQF,CAAC,IAAMC,CAAC,EAAE,OAAYD,GAAAF,EAAU,QAAQE,CAAC,IAAML,EAAMK,CAAC,CAAC,EAI5K,OAAAF,EAAU,QAAUH,EACjBC,EAAA,UACIO,EAACX,EAAO,CAAA,GAAGG,EACX,SAAA,CAAAD,EAAS,kBACME,EAAG,QAAQ,KAAGG,EAAa,KAAK,IAAI,EAAE,IACxD,CAAA,CAAA,CAAA,CACL,EACKK,EAAkBb,EAAgBc,CAAI,EACtCC,EAAoBf,EAAgBgB,CAAM,EAC1CC,EAAmBjB,EAAgBkB,CAAK,EACxCC,EAAoBnB,EAAgBoB,CAAM,EAC1CC,EAAuBrB,EAAgBsB,CAAS,EAChDC,EAAc,CAClB,QAAS,cACX,EACaC,EAAe,IAAM,CAChC,KAAM,CAACC,EAAMC,CAAO,EAAIC,WAAS7B,CAAW,EACtC,CACJ,KAAA8B,EACA,MAAAC,EACA,SAAAC,EACA,QAAAC,GACEC,EAAQ,CACV,KAAAP,EACA,SAAqBQ,GAAA,CACF,OAAO,QAAQ,kBAAkB,OAAO,OAAOA,CAAO,EAAE,KAAK,IAAI,IAAI,GAC1EP,EAAQO,CAAO,CAC7B,CAAA,CACD,EACM,OAAArB,EAAC,OAAM,CAAA,GAAGgB,EACb,SAAA,CAAAM,EAACrB,GAAgB,SAAQ,GAAE,GAAGgB,EAAM,MAAM,EAAG,SAE7C,MAAA,CAAA,EACAK,EAACnB,GAAkB,SAAQ,GAAE,GAAGc,EAAM,KAAK,EAAG,SAE9C,QAAA,CAAA,EACAK,EAACjB,EAAiB,CAAA,MAAOM,EAAa,SAAQ,GAAE,GAAGM,EAAM,MAAM,EAAG,SAElE,MAAA,CAAA,EACAK,EAACf,GAAkB,SAAQ,GAAC,QAAApB,EAAmB,GAAG8B,EAAM,QAAQ,EAAG,SAEnE,QAAA,CAAA,EAEAK,EAAC,OAAI,MAAO,CACZ,MAAO,MAAA,EACN,IACAb,EACC,CAAA,SAAA,CAAAa,EAAC,SAAO,CAAA,SAAU,CAACJ,EAAU,SAAM,SAAA,EACnCI,EAAC,UAAO,KAAK,SAAS,SAAU,CAACJ,EAAU,QAASC,EAAS,SAE7D,OAAA,CAAA,CAAA,EACF,CACF,CAAA,CAAA,CACJ,EACeI,EAAA,CACb,MAAO,wBACP,WAAY,CACV,QAAS,CACP,UAAW,EACb,CACF,CACF,YACAX,EAAa,WAAa,CACxB,GAAGA,EAAa,WAChB,KAAM,CACJ,IAAGY,EAAAZ,EAAa,aAAb,YAAAY,EAAyB,KAC5B,OAAQ,CACN,eAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAChB,IAAGC,GAAAC,EAAAd,EAAa,aAAb,YAAAc,EAAyB,OAAzB,YAAAD,EAA+B,MACpC,CACF,CACF"}